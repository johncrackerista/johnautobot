const instagram_downloader = require('../index')

test('Create new url, add ?__a=1 for get Graphql data with / at the end', () => {
    expect(instagram_downloader.createNewUrl('https://www.instagram.com/p/B_FrqCDHQA1/')).toBe('https://www.instagram.com/p/B_FrqCDHQA1/?__a=1');
});

test('Create new url, add ?__a=1 for get Graphql data with not / at the end', () => {
    expect(instagram_downloader.createNewUrl('https://www.instagram.com/p/B_FrqCDHQA1')).toBe('https://www.instagram.com/p/B_FrqCDHQA1/?__a=1');
});

test('Return media is video', () => {
    const metaData = '{"shortcode_media":{"__typename":"GraphImage","id":"2289427990005481525","shortcode":"B_FrqCDHQA1","dimensions":{"height":1350,"width":1080},"gating_info":null,"fact_check_overall_rating":null,"fact_check_information":null,"sensitivity_friction_info":null,"media_overlay_info":null,"media_preview":"ACEqYrfvOMcEVkz8SsT03n+dao2pvY9QScfTOKeEFxB8wAz827PIwent/Kp7Gncypz+8bH+eBWhp5+Uf7x/pURtVkBfJLHqo5P5daktBtwOnzdPyqZaIa3+86bFFFFYiObaLO44ByMghgSfbHWiybyImLDl84GMkcY+YdgTyKdKV2FkG09M56+oHNZ6SF84PLED0/wA9a60tDPmd7lu3PzbyOUBBIJBOcdx/WrbOJZFdV25OD7kY5NMjtSkbg4k3bdu04Ix1OT/XrU3lCFg6hmKAkE4wSR16/wCccVnJpplK66Gzmisr7T7N/wB80ViO5RmG4nd8qLxydvPoPf1xSWkCRIZjnDZCgjkY6np/hSS/M7Z5+bv+NSyH5QOwUY/M1vJ8yIsNdicADGRnPqCcfTrSMrOAc8Djk/0+tVyfm/z6VdjGU/CpWw76EXmt6/qP8KKn2j0FFTYVj//Z","display_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/e35/p1080x1080/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=2629f7335b81cb1d8e99c568d41e3197&oe=5ECBA8A7","display_resources":[{"src":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/sh0.08/e35/p640x640/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=662d41e5a9831738fdb04917f145b45d&oe=5ECB0CC4","config_width":640,"config_height":800},{"src":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/sh0.08/e35/p750x750/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=d75d0bc51a73d02be59eebb0b6896aa5&oe=5EC84944","config_width":750,"config_height":937},{"src":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/e35/p1080x1080/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=2629f7335b81cb1d8e99c568d41e3197&oe=5ECBA8A7","config_width":1080,"config_height":1350}],"accessibility_caption":"Photo by Cat Storiess on April 17, 2020. L\u2019image contient peut-\u00eatre\u00a0: 1 personne","is_video":true,"tracking_token":"eyJ2ZXJzaW9uIjo1LCJwYXlsb2FkIjp7ImlzX2FuYWx5dGljc190cmFja2VkIjpmYWxzZSwidXVpZCI6IjgyYzAzODYxMDdjODRmODZiYjJhOTNiNDE3ZmZkMzA0MjI4OTQyNzk5MDAwNTQ4MTUyNSJ9LCJzaWduYXR1cmUiOiIifQ==","edge_media_to_tagged_user":{"edges":[]},"edge_media_to_caption":{"edges":[{"node":{"text":"From @pamirthecat: \u201cCouple goals \ud83d\udc9e\u201d -->@cats_of_instagram-Double tap \ud83d\ude0d-#cat #cats #catsofinstagram"}}]},"caption_is_edited":false,"has_ranked_comments":false,"edge_media_to_parent_comment":{"count":1,"page_info":{"has_next_page":false,"end_cursor":null},"edges":[{"node":{"id":"18100302277192153","text":"Thank you for the feature \ud83d\ude3b\u2764\ufe0f","created_at":1587141589,"did_report_as_spam":false,"owner":{"id":"8288989561","is_verified":false,"profile_pic_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-19/s150x150/83738083_186122719308013_940067563981766656_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_ohc=6_r86knn-XwAX8nNcMk&oh=ca63b0b4ffbdbeb05355aff977f78559&oe=5EC8EC45","username":"pamirthecat"},"viewer_has_liked":false,"edge_liked_by":{"count":0},"is_restricted_pending":false,"edge_threaded_comments":{"count":0,"page_info":{"has_next_page":false,"end_cursor":null},"edges":[]}}}]},"edge_media_to_hoisted_comment":{"edges":[]},"edge_media_preview_comment":{"count":1,"edges":[{"node":{"id":"18100302277192153","text":"Thank you for the feature \ud83d\ude3b\u2764\ufe0f","created_at":1587141589,"did_report_as_spam":false,"owner":{"id":"8288989561","is_verified":false,"profile_pic_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-19/s150x150/83738083_186122719308013_940067563981766656_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_ohc=6_r86knn-XwAX8nNcMk&oh=ca63b0b4ffbdbeb05355aff977f78559&oe=5EC8EC45","username":"pamirthecat"},"viewer_has_liked":false,"edge_liked_by":{"count":0},"is_restricted_pending":false}}]},"comments_disabled":false,"commenting_disabled_for_viewer":false,"taken_at_timestamp":1587141105,"edge_media_preview_like":{"count":6,"edges":[]},"edge_media_to_sponsor_user":{"edges":[]},"location":null,"viewer_has_liked":false,"viewer_has_saved":false,"viewer_has_saved_to_collection":false,"viewer_in_photo_of_you":false,"viewer_can_reshare":true,"owner":{"id":"7772228857","is_verified":false,"profile_pic_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-19/s150x150/92756157_1782905071849520_1409901715892731904_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_ohc=dKps4gpVsHQAX_Lhe8o&oh=943ae0b8bad0a6f1ad37d37ffecb4b2e&oe=5EC8757E","username":"cats_meow_stories","blocked_by_viewer":false,"restricted_by_viewer":null,"followed_by_viewer":false,"full_name":"Cat Storiess","has_blocked_viewer":false,"is_private":false,"is_unpublished":false,"requested_by_viewer":false,"edge_owner_to_timeline_media":{"count":37}},"is_ad":false,"edge_web_media_to_related_media":{"edges":[]}}}'
    expect(instagram_downloader.getMediaType(JSON.parse(metaData))).toBe('video');
});

test('Return media is image', () => {
    const metaData = '{"shortcode_media":{"__typename":"GraphImage","id":"2289427990005481525","shortcode":"B_FrqCDHQA1","dimensions":{"height":1350,"width":1080},"gating_info":null,"fact_check_overall_rating":null,"fact_check_information":null,"sensitivity_friction_info":null,"media_overlay_info":null,"media_preview":"ACEqYrfvOMcEVkz8SsT03n+dao2pvY9QScfTOKeEFxB8wAz827PIwent/Kp7Gncypz+8bH+eBWhp5+Uf7x/pURtVkBfJLHqo5P5daktBtwOnzdPyqZaIa3+86bFFFFYiObaLO44ByMghgSfbHWiybyImLDl84GMkcY+YdgTyKdKV2FkG09M56+oHNZ6SF84PLED0/wA9a60tDPmd7lu3PzbyOUBBIJBOcdx/WrbOJZFdV25OD7kY5NMjtSkbg4k3bdu04Ix1OT/XrU3lCFg6hmKAkE4wSR16/wCccVnJpplK66Gzmisr7T7N/wB80ViO5RmG4nd8qLxydvPoPf1xSWkCRIZjnDZCgjkY6np/hSS/M7Z5+bv+NSyH5QOwUY/M1vJ8yIsNdicADGRnPqCcfTrSMrOAc8Djk/0+tVyfm/z6VdjGU/CpWw76EXmt6/qP8KKn2j0FFTYVj//Z","display_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/e35/p1080x1080/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=2629f7335b81cb1d8e99c568d41e3197&oe=5ECBA8A7","display_resources":[{"src":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/sh0.08/e35/p640x640/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=662d41e5a9831738fdb04917f145b45d&oe=5ECB0CC4","config_width":640,"config_height":800},{"src":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/sh0.08/e35/p750x750/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=d75d0bc51a73d02be59eebb0b6896aa5&oe=5EC84944","config_width":750,"config_height":937},{"src":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-15/e35/p1080x1080/92987255_664558847424740_6717549677124925009_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_cat=108&_nc_ohc=aWcPJSzud5wAX8kM50z&oh=2629f7335b81cb1d8e99c568d41e3197&oe=5ECBA8A7","config_width":1080,"config_height":1350}],"accessibility_caption":"Photo by Cat Storiess on April 17, 2020. L\u2019image contient peut-\u00eatre\u00a0: 1 personne","is_video":false,"tracking_token":"eyJ2ZXJzaW9uIjo1LCJwYXlsb2FkIjp7ImlzX2FuYWx5dGljc190cmFja2VkIjpmYWxzZSwidXVpZCI6IjgyYzAzODYxMDdjODRmODZiYjJhOTNiNDE3ZmZkMzA0MjI4OTQyNzk5MDAwNTQ4MTUyNSJ9LCJzaWduYXR1cmUiOiIifQ==","edge_media_to_tagged_user":{"edges":[]},"edge_media_to_caption":{"edges":[{"node":{"text":"From @pamirthecat: \u201cCouple goals \ud83d\udc9e\u201d -->@cats_of_instagram-Double tap \ud83d\ude0d-#cat #cats #catsofinstagram"}}]},"caption_is_edited":false,"has_ranked_comments":false,"edge_media_to_parent_comment":{"count":1,"page_info":{"has_next_page":false,"end_cursor":null},"edges":[{"node":{"id":"18100302277192153","text":"Thank you for the feature \ud83d\ude3b\u2764\ufe0f","created_at":1587141589,"did_report_as_spam":false,"owner":{"id":"8288989561","is_verified":false,"profile_pic_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-19/s150x150/83738083_186122719308013_940067563981766656_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_ohc=6_r86knn-XwAX8nNcMk&oh=ca63b0b4ffbdbeb05355aff977f78559&oe=5EC8EC45","username":"pamirthecat"},"viewer_has_liked":false,"edge_liked_by":{"count":0},"is_restricted_pending":false,"edge_threaded_comments":{"count":0,"page_info":{"has_next_page":false,"end_cursor":null},"edges":[]}}}]},"edge_media_to_hoisted_comment":{"edges":[]},"edge_media_preview_comment":{"count":1,"edges":[{"node":{"id":"18100302277192153","text":"Thank you for the feature \ud83d\ude3b\u2764\ufe0f","created_at":1587141589,"did_report_as_spam":false,"owner":{"id":"8288989561","is_verified":false,"profile_pic_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-19/s150x150/83738083_186122719308013_940067563981766656_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_ohc=6_r86knn-XwAX8nNcMk&oh=ca63b0b4ffbdbeb05355aff977f78559&oe=5EC8EC45","username":"pamirthecat"},"viewer_has_liked":false,"edge_liked_by":{"count":0},"is_restricted_pending":false}}]},"comments_disabled":false,"commenting_disabled_for_viewer":false,"taken_at_timestamp":1587141105,"edge_media_preview_like":{"count":6,"edges":[]},"edge_media_to_sponsor_user":{"edges":[]},"location":null,"viewer_has_liked":false,"viewer_has_saved":false,"viewer_has_saved_to_collection":false,"viewer_in_photo_of_you":false,"viewer_can_reshare":true,"owner":{"id":"7772228857","is_verified":false,"profile_pic_url":"https://instagram.fcdg1-1.fna.fbcdn.net/v/t51.2885-19/s150x150/92756157_1782905071849520_1409901715892731904_n.jpg?_nc_ht=instagram.fcdg1-1.fna.fbcdn.net&_nc_ohc=dKps4gpVsHQAX_Lhe8o&oh=943ae0b8bad0a6f1ad37d37ffecb4b2e&oe=5EC8757E","username":"cats_meow_stories","blocked_by_viewer":false,"restricted_by_viewer":null,"followed_by_viewer":false,"full_name":"Cat Storiess","has_blocked_viewer":false,"is_private":false,"is_unpublished":false,"requested_by_viewer":false,"edge_owner_to_timeline_media":{"count":37}},"is_ad":false,"edge_web_media_to_related_media":{"edges":[]}}}'
    expect(instagram_downloader.getMediaType(JSON.parse(metaData))).toBe('image');
});